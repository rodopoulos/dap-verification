%
\begin{isabellebody}%
  \setisabellecontext{Smartphone}%
  %
  \isadelimtheory
  \isanewline
  \isanewline
  %
  \endisadelimtheory
  %
  \isatagtheory
  \isacommand{theory}\isamarkupfalse%
  \ Smartphone\ \isakeyword{imports}\ {\isachardoublequoteopen}{\isachardot}{\isacharslash}EventSP{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}Auth{\isacharslash}All{\isacharunderscore}Symmetric{\isachardoublequoteclose}\ \isakeyword{begin}%
  \endisatagtheory
  {\isafoldtheory}%
  %
  \isadelimtheory
  \isanewline
  %
  \endisadelimtheory
  \isanewline
  \isanewline
  \isacommand{axiomatization}\isamarkupfalse%
  \isanewline
  \ \ shrK\ \ {\isacharcolon}{\isacharcolon}\ \ {\isachardoublequoteopen}agent\ {\isasymRightarrow}\ key{\isachardoublequoteclose}\isanewline
  \isanewline
  \isakeyword{where}\isanewline
  \ \ inj{\isacharunderscore}shrK\ {\isacharcolon}\ {\isachardoublequoteopen}inj\ shrK{\isachardoublequoteclose}%
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Smartphone Usage%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  \isacommand{definition}\isamarkupfalse%
  \ legalUse\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}smartphone\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isacharparenleft}{\isachardoublequoteopen}legalUse\ {\isacharparenleft}{\isacharunderscore}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\ \isakeyword{where}\isanewline
  \ \ {\isachardoublequoteopen}legalUse\ P\ {\isacharequal}{\isacharequal}\ P\ {\isasymnotin}\ stolen{\isachardoublequoteclose}\isanewline
  \isanewline
  \isanewline
  \isacommand{primrec}\isamarkupfalse%
  \ illegalUse\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}smartphone\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
  \ \ illegalUse{\isacharunderscore}def{\isacharcolon}\ {\isachardoublequoteopen}illegalUse\ {\isacharparenleft}Smartphone\ A{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}\isanewline
  \ \ \ \ {\isacharparenleft}insecureP\ {\isasymand}\ {\isacharparenleft}Smartphone\ A\ {\isasymin}\ stolen{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}Smartphone\ A\ {\isasymin}\ badP{\isacharparenright}{\isacharparenright}\ {\isasymor}\isanewline
  \ \ \ \ {\isacharparenleft}secureP\ \ \ {\isasymand}\ {\isacharparenleft}Smartphone\ A\ {\isasymin}\ stolen{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Agents' Initial State%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  \isacommand{overloading}\isamarkupfalse%
  \ initState\ {\isasymequiv}\ initState\isanewline
  \ \ \isakeyword{begin}\isanewline
  \ \ \isacommand{primrec}\isamarkupfalse%
  \ initState\ \isakeyword{where}\isanewline
  \ \ \ \ initState{\isacharunderscore}Server\ {\isacharcolon}\ {\isachardoublequoteopen}initState\ Server\ {\isacharequal}\ {\isacharparenleft}Key{\isacharbackquote}\ {\isacharparenleft}range\ shrK{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
  \ \ \ \ initState{\isacharunderscore}Friend\ {\isacharcolon}\ {\isachardoublequoteopen}initState\ {\isacharparenleft}Friend\ i{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
  \ \ \ \ initState{\isacharunderscore}Spy\ {\isacharcolon}\ {\isachardoublequoteopen}initState\ Spy\ {\isacharequal}\ {\isacharparenleft}Key{\isacharbackquote}\ {\isacharparenleft}shrK{\isacharbackquote}\ {\isacharbraceleft}A{\isachardot}\ Smartphone\ A\ {\isasymin}\ badP{\isacharbraceright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
  \isacommand{end}\isamarkupfalse%
  \isanewline
  \isanewline
  \isacommand{axiomatization}\isamarkupfalse%
  \ \isakeyword{where}\isanewline
  \ \ Key{\isacharunderscore}supply{\isacharunderscore}ax{\isacharcolon}\ {\isachardoublequoteopen}finite\ KK\ {\isasymLongrightarrow}\ {\isasymexists}\ K{\isachardot}\ K\ {\isasymnotin}\ KK\ {\isacharampersand}\ Key\ K\ {\isasymnotin}\ used\ evs\ {\isachardoublequoteclose}\ \isakeyword{and}\isanewline
  \ \ \isanewline
  \ \ \isanewline
  \ \ Nonce{\isacharunderscore}supply{\isacharunderscore}ax{\isacharcolon}\ {\isachardoublequoteopen}finite\ NN\ {\isasymLongrightarrow}\ {\isasymexists}\ N{\isachardot}\ N\ {\isasymnotin}\ NN\ {\isacharampersand}\ Nonce\ N\ {\isasymnotin}\ used\ evs{\isachardoublequoteclose}%
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Shared Key Properties%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  \isacommand{declare}\isamarkupfalse%
  \ inj{\isacharunderscore}shrK\ {\isacharbrackleft}THEN\ inj{\isacharunderscore}eq{\isacharcomma}\ iff{\isacharbrackright}\isanewline
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ invKey{\isacharunderscore}K\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}invKey\ K\ {\isacharequal}\ K{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}insert\ isSym{\isacharunderscore}keys{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp\ add{\isacharcolon}\ symKeys{\isacharunderscore}def{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ analz{\isacharunderscore}Decrypt{\isacharprime}\ {\isacharbrackleft}dest{\isacharbrackright}{\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}{\isasymlbrakk}\ Crypt\ K\ X\ {\isasymin}\ analz\ H{\isacharsemicolon}\ Key\ K\ {\isasymin}\ analz\ H\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ X\ {\isasymin}\ analz\ H{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}erule\ analz{\isachardot}Decrypt{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{declare}\isamarkupfalse%
  \ analz{\isachardot}Decrypt\ {\isacharbrackleft}rule\ del{\isacharbrackright}\isanewline
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ parts{\isacharunderscore}image{\isacharunderscore}Nonce\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}parts\ {\isacharparenleft}Nonce{\isacharbackquote}\ N{\isacharparenright}\ {\isacharequal}\ Nonce{\isacharbackquote}\ N{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ auto%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ keysFor{\isacharunderscore}parts{\isacharunderscore}initState\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ \isanewline
  \ \ {\isachardoublequoteopen}keysFor\ {\isacharparenleft}parts\ {\isacharparenleft}initState\ C{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}unfold\ keysFor{\isacharunderscore}def{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}induct{\isacharunderscore}tac\ {\isachardoublequoteopen}C{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ keysFor{\isacharunderscore}parts{\isacharunderscore}insert\ {\isacharcolon}\ \isanewline
  \ \ {\isachardoublequoteopen}{\isasymlbrakk}\ K\ {\isasymin}\ keysFor\ {\isacharparenleft}parts\ {\isacharparenleft}insert\ X\ G{\isacharparenright}{\isacharparenright}{\isacharsemicolon}\ X\ {\isasymin}\ synth\ {\isacharparenleft}analz\ H{\isacharparenright}\ {\isasymrbrakk}\isanewline
  \ \ \ \ {\isasymLongrightarrow}\ K\ {\isasymin}\ keysFor\ {\isacharparenleft}parts\ {\isacharparenleft}G\ {\isasymunion}\ H{\isacharparenright}{\isacharparenright}\ {\isacharbar}\ Key\ K\ {\isasymin}\ parts\ H{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ {\isacharparenleft}force\ dest{\isacharcolon}\ EventSP{\isachardot}keysFor{\isacharunderscore}parts{\isacharunderscore}insert{\isacharparenright}%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ Crypt{\isacharunderscore}imp{\isacharunderscore}keysFor\ {\isacharcolon}\ \isanewline
  \ \ {\isachardoublequoteopen}Crypt\ K\ X\ {\isasymin}\ H\ {\isasymLongrightarrow}\ K\ {\isasymin}\ keysFor\ H{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ {\isacharparenleft}drule\ Crypt{\isacharunderscore}imp{\isacharunderscore}invKey{\isacharunderscore}keysFor{\isacharcomma}\ simp{\isacharparenright}%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ shrK{\isacharunderscore}in{\isacharunderscore}initState\ {\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Key\ {\isacharparenleft}shrK\ A{\isacharparenright}\ {\isasymin}\ initState\ Server{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}induct{\isacharunderscore}tac\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ simp{\isacharunderscore}all\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ shrK{\isacharunderscore}not{\isacharunderscore}in{\isacharunderscore}other\ {\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Key\ {\isacharparenleft}shrK\ {\isacharparenleft}Friend\ x{\isacharparenright}{\isacharparenright}\ {\isasymin}\ initState\ {\isacharparenleft}Friend\ y{\isacharparenright}\ {\isasymLongrightarrow}\ {\isacharparenleft}x\ {\isacharequal}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ simp\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ shrK{\isacharunderscore}in{\isacharunderscore}used\ {\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Key\ {\isacharparenleft}shrK\ A{\isacharparenright}\ {\isasymin}\ used\ evs{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}rule\ initState{\isacharunderscore}into{\isacharunderscore}used{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ blast\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \begin{isamarkuptext}%
  If a key is fresh, then it must not a long-term key%
  \end{isamarkuptext}\isamarkuptrue%
  \isacommand{lemma}\isamarkupfalse%
  \ Key{\isacharunderscore}not{\isacharunderscore}used\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Key\ K\ {\isasymnotin}\ used\ evs\ {\isasymLongrightarrow}\ K\ {\isasymnotin}\ range\ shrK{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ shrK{\isacharunderscore}neq\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Key\ K\ {\isasymnotin}\ used\ evs\ {\isasymLongrightarrow}\ shrK\ B\ {\isasymnoteq}\ K{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{declare}\isamarkupfalse%
  \ shrK{\isacharunderscore}neq\ {\isacharbrackleft}THEN\ not{\isacharunderscore}sym{\isacharcomma}\ simp{\isacharbrackright}%
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Function \isa{knows}%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  \isacommand{lemma}\isamarkupfalse%
  \ Spy{\isacharunderscore}knows{\isacharunderscore}bad{\isacharunderscore}phones\ {\isacharbrackleft}intro{\isacharbang}{\isacharbrackright}\ {\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}Smartphone\ A\ {\isasymin}\ badP\ {\isasymLongrightarrow}\ Key\ {\isacharparenleft}shrK\ A{\isacharparenright}\ {\isasymin}\ knows\ Spy\ evs{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  \isanewline
  \ \ %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}induct{\isacharunderscore}tac\ {\isachardoublequoteopen}evs{\isachardoublequoteclose}{\isacharparenright}\isanewline
  \ \ \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp{\isacharunderscore}all\ {\isacharparenleft}no{\isacharunderscore}asm{\isacharunderscore}simp{\isacharparenright}\ add{\isacharcolon}\ imageI\ knows{\isacharunderscore}Cons\ split{\isacharcolon}\ event{\isachardot}split{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ Spy{\isacharunderscore}knows{\isacharunderscore}stolen{\isacharunderscore}phones\ {\isacharbrackleft}intro{\isacharbang}{\isacharbrackright}\ {\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}Smartphone\ A\ {\isasymin}\ stolen\ {\isasymLongrightarrow}\ Key\ {\isacharparenleft}shrK\ A{\isacharparenright}\ {\isasymin}\ knows\ Spy\ evs{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  \isanewline
  \ \ %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}induct{\isacharunderscore}tac\ {\isachardoublequoteopen}evs{\isachardoublequoteclose}{\isacharparenright}\isanewline
  \ \ \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp{\isacharunderscore}all\ {\isacharparenleft}no{\isacharunderscore}asm{\isacharunderscore}simp{\isacharparenright}\ add{\isacharcolon}\ imageI\ knows{\isacharunderscore}Cons\ split{\isacharcolon}\ event{\isachardot}split{\isacharparenright}\isanewline
  \isacommand{using}\isamarkupfalse%
  \ Stolen{\isacharunderscore}in{\isacharunderscore}badP\ \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ Crypt{\isacharunderscore}Spy{\isacharunderscore}analz{\isacharunderscore}bad\ {\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}{\isasymlbrakk}\ Crypt\ {\isacharparenleft}shrK\ A{\isacharparenright}\ X\ {\isasymin}\ analz\ {\isacharparenleft}knows\ Spy\ evs{\isacharparenright}{\isacharsemicolon}\ Smartphone\ A\ {\isasymin}\ badP\ {\isasymrbrakk}\ \isanewline
  \ \ \ \ {\isasymLongrightarrow}\ X\ {\isasymin}\ analz\ {\isacharparenleft}knows\ Spy\ evs{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  \isanewline
  \ \ %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}erule\ analz{\isachardot}Decrypt{\isacharparenright}\isanewline
  \ \ \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp\ add{\isacharcolon}\ Spy{\isacharunderscore}knows{\isacharunderscore}bad{\isacharunderscore}phones{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ Crypt{\isacharunderscore}Spy{\isacharunderscore}analz{\isacharunderscore}stolen\ {\isacharcolon}\ \isanewline
  \ \ {\isachardoublequoteopen}{\isasymlbrakk}\ Crypt\ {\isacharparenleft}shrK\ A{\isacharparenright}\ X\ {\isasymin}\ analz\ {\isacharparenleft}knows\ Spy\ evs{\isacharparenright}{\isacharsemicolon}\ Smartphone\ A\ {\isasymin}\ stolen\ {\isasymrbrakk}\ \isanewline
  \ \ \ \ {\isasymLongrightarrow}\ X\ {\isasymin}\ analz\ {\isacharparenleft}knows\ Spy\ evs{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  \isanewline
  \ \ %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}erule\ analz{\isachardot}Decrypt{\isacharparenright}\isanewline
  \ \ \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}simp\ add{\isacharcolon}\ Spy{\isacharunderscore}knows{\isacharunderscore}stolen{\isacharunderscore}phones{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Nonce Lemmas%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  \isacommand{lemma}\isamarkupfalse%
  \ Nonce{\isacharunderscore}notin{\isacharunderscore}initState\ {\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}Nonce\ N\ {\isasymnotin}\ parts\ {\isacharparenleft}initState\ {\isacharparenleft}Friend\ i{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ auto%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ subset{\isacharunderscore}Compl{\isacharunderscore}range{\isacharunderscore}shrK{\isacharcolon}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharminus}\ {\isacharparenleft}range\ shrK{\isacharparenright}\ {\isasymLongrightarrow}\ shrK\ x\ {\isasymnotin}\ A{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ insert{\isacharunderscore}Key{\isacharunderscore}singleton{\isacharcolon}\ {\isachardoublequoteopen}insert\ {\isacharparenleft}Key\ K{\isacharparenright}\ H\ {\isacharequal}\ Key\ {\isacharbackquote}\ {\isacharbraceleft}K{\isacharbraceright}\ {\isasymunion}\ H{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ insert{\isacharunderscore}Key{\isacharunderscore}image{\isacharcolon}\ {\isachardoublequoteopen}insert\ {\isacharparenleft}Key\ K{\isacharparenright}\ {\isacharparenleft}Key{\isacharbackquote}KK\ {\isasymunion}\ C{\isacharparenright}\ {\isacharequal}\ Key{\isacharbackquote}{\isacharparenleft}insert\ K\ KK{\isacharparenright}\ {\isasymunion}\ C{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ blast%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ Nonce{\isacharunderscore}supply\ {\isacharcolon}\isanewline
  \ \ {\isachardoublequoteopen}Nonce\ {\isacharparenleft}SOME\ N{\isachardot}\ Nonce\ N\ {\isasymnotin}\ used\ evs{\isacharparenright}\ {\isasymnotin}\ used\ evs{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}rule\ finite{\isachardot}emptyI\ {\isacharbrackleft}THEN\ Nonce{\isacharunderscore}supply{\isacharunderscore}ax{\isacharcomma}\ THEN\ exE{\isacharbrackright}{\isacharparenright}\isanewline
  \isacommand{apply}\isamarkupfalse%
  \ {\isacharparenleft}rule\ someI{\isacharcomma}\ blast{\isacharparenright}\isanewline
  \isacommand{done}\isamarkupfalse%
  %
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isacommand{lemmas}\isamarkupfalse%
  \ analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}simps\ {\isacharequal}\isanewline
  \ \ \ \ \ \ \ simp{\isacharunderscore}thms\ mem{\isacharunderscore}simps\ %
  \isamarkupcmt{these two allow its use with \isa{only{\isacharcolon}}%
  }\isanewline
  \ \ \ \ \ \ \ disj{\isacharunderscore}comms\ \isanewline
  \ \ \ \ \ \ \ image{\isacharunderscore}insert\ {\isacharbrackleft}THEN\ sym{\isacharbrackright}\ image{\isacharunderscore}Un\ {\isacharbrackleft}THEN\ sym{\isacharbrackright}\ empty{\isacharunderscore}subsetI\ insert{\isacharunderscore}subset\isanewline
  \ \ \ \ \ \ \ analz{\isacharunderscore}insert{\isacharunderscore}eq\ Un{\isacharunderscore}upper{\isadigit{2}}\ {\isacharbrackleft}THEN\ analz{\isacharunderscore}mono{\isacharcomma}\ THEN\ {\isacharbrackleft}{\isadigit{2}}{\isacharbrackright}\ rev{\isacharunderscore}subsetD{\isacharbrackright}\isanewline
  \ \ \ \ \ \ \ insert{\isacharunderscore}Key{\isacharunderscore}singleton\ subset{\isacharunderscore}Compl{\isacharunderscore}range{\isacharunderscore}shrK\isanewline
  \ \ \ \ \ \ \ Key{\isacharunderscore}not{\isacharunderscore}used\ insert{\isacharunderscore}Key{\isacharunderscore}image\ Un{\isacharunderscore}assoc\ {\isacharbrackleft}THEN\ sym{\isacharbrackright}\isanewline
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}lemma{\isacharcolon}\isanewline
  \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}Key\ K\ {\isasymin}\ analz\ {\isacharparenleft}Key{\isacharbackquote}nE\ {\isasymunion}\ H{\isacharparenright}{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}K\ {\isasymin}\ nE\ {\isacharbar}\ Key\ K\ {\isasymin}\ analz\ H{\isacharparenright}\ \ {\isasymLongrightarrow}\ \ \isanewline
  \ \ \ \ \ \ \ \ \ {\isacharparenleft}Key\ K\ {\isasymin}\ analz\ {\isacharparenleft}Key{\isacharbackquote}nE\ {\isasymunion}\ H{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}K\ {\isasymin}\ nE\ {\isacharbar}\ Key\ K\ {\isasymin}\ analz\ H{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ {\isacharparenleft}blast\ intro{\isacharcolon}\ analz{\isacharunderscore}mono\ {\isacharbrackleft}THEN\ {\isacharbrackleft}{\isadigit{2}}{\isacharbrackright}\ rev{\isacharunderscore}subsetD{\isacharbrackright}{\isacharparenright}%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isatagdocument
  %
  \isamarkupsection{Tactics for possibility theorems%
  }
  \isamarkuptrue%
  %
  \endisatagdocument
  {\isafolddocument}%
  %
  \isadelimdocument
  %
  \endisadelimdocument
  %
  \isadelimML
  %
  \endisadelimML
  %
  \isatagML
  \isacommand{ML}\isamarkupfalse%
  \isanewline
  {\isacartoucheopen}\isanewline
  structure\ Smartphone\ {\isacharequal}\isanewline
  struct\isanewline
  \isanewline
  {\isacharparenleft}{\isacharasterisk}Omitting\ used{\isacharunderscore}Says\ makes\ the\ tactic\ much\ faster{\isacharcolon}\ it\ leaves\ expressions\isanewline
  \ \ \ \ such\ as\ \ Nonce\ {\isacharquery}N\ {\isasymnotin}\ used\ evs\ that\ match\ Nonce{\isacharunderscore}supply{\isacharasterisk}{\isacharparenright}\isanewline
  fun\ possibility{\isacharunderscore}tac\ ctxt\ {\isacharequal}\isanewline
  \ \ \ {\isacharparenleft}REPEAT\ \isanewline
  \ \ \ \ {\isacharparenleft}ALLGOALS\ {\isacharparenleft}simp{\isacharunderscore}tac\ {\isacharparenleft}ctxt\isanewline
  \ \ \ \ \ \ delsimps\ {\isacharat}{\isacharbraceleft}thms\ used{\isacharunderscore}Cons{\isacharunderscore}simps{\isacharbraceright}\isanewline
  \ \ \ \ \ \ setSolver\ safe{\isacharunderscore}solver{\isacharparenright}{\isacharparenright}\isanewline
  \ \ \ \ \ THEN\isanewline
  \ \ \ \ \ REPEAT{\isacharunderscore}FIRST\ {\isacharparenleft}eq{\isacharunderscore}assume{\isacharunderscore}tac\ ORELSE{\isacharprime}\ \isanewline
  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolve{\isacharunderscore}tac\ ctxt\ {\isacharbrackleft}refl{\isacharcomma}\ conjI{\isacharcomma}\ {\isacharat}{\isacharbraceleft}thm\ Nonce{\isacharunderscore}supply{\isacharbraceright}{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
  \isanewline
  {\isacharparenleft}{\isacharasterisk}For\ harder\ protocols\ {\isacharparenleft}such\ as\ Recur{\isacharparenright}\ where\ we\ have\ to\ set\ up\ some\isanewline
  \ \ nonces\ and\ keys\ initially{\isacharasterisk}{\isacharparenright}\isanewline
  fun\ basic{\isacharunderscore}possibility{\isacharunderscore}tac\ ctxt\ {\isacharequal}\isanewline
  \ \ \ \ REPEAT\ \isanewline
  \ \ \ \ {\isacharparenleft}ALLGOALS\ {\isacharparenleft}asm{\isacharunderscore}simp{\isacharunderscore}tac\ {\isacharparenleft}ctxt\ setSolver\ safe{\isacharunderscore}solver{\isacharparenright}{\isacharparenright}\isanewline
  \ \ \ \ \ THEN\isanewline
  \ \ \ \ \ REPEAT{\isacharunderscore}FIRST\ {\isacharparenleft}resolve{\isacharunderscore}tac\ ctxt\ {\isacharbrackleft}refl{\isacharcomma}\ conjI{\isacharbrackright}{\isacharparenright}{\isacharparenright}\isanewline
  \isanewline
  val\ analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}ss\ {\isacharequal}\ \isanewline
  \ \ simpset{\isacharunderscore}of\isanewline
  \ \ \ {\isacharparenleft}{\isacharat}{\isacharbraceleft}context{\isacharbraceright}\ delsimps\ {\isacharbrackleft}image{\isacharunderscore}insert{\isacharcomma}\ image{\isacharunderscore}Un{\isacharbrackright}\isanewline
  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delsimps\ {\isacharbrackleft}{\isacharat}{\isacharbraceleft}thm\ imp{\isacharunderscore}disjL{\isacharbraceright}{\isacharbrackright}\ \ \ \ {\isacharparenleft}{\isacharasterisk}reduces\ blow{\isacharminus}up{\isacharasterisk}{\isacharparenright}\isanewline
  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addsimps\ {\isacharat}{\isacharbraceleft}thms\ analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}simps{\isacharbraceright}{\isacharparenright}\isanewline
  end\isanewline
  {\isacartoucheclose}%
  \endisatagML
  {\isafoldML}%
  %
  \isadelimML
  \isanewline
  %
  \endisadelimML
  \isanewline
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ invKey{\isacharunderscore}shrK{\isacharunderscore}iff\ {\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\isanewline
  \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}Key\ {\isacharparenleft}invKey\ K{\isacharparenright}\ {\isasymin}\ X{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Key\ K\ {\isasymin}\ X{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ auto%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  %
  \isadelimML
  \isanewline
  %
  \endisadelimML
  %
  \isatagML
  \isacommand{method{\isacharunderscore}setup}\isamarkupfalse%
  \ analz{\isacharunderscore}freshK\ {\isacharequal}\ {\isacartoucheopen}\isanewline
  \ \ \ \ Scan{\isachardot}succeed\ {\isacharparenleft}fn\ ctxt\ {\isacharequal}{\isachargreater}\isanewline
  \ \ \ \ \ {\isacharparenleft}SIMPLE{\isacharunderscore}METHOD\isanewline
  \ \ \ \ \ \ {\isacharparenleft}EVERY\ {\isacharbrackleft}REPEAT{\isacharunderscore}FIRST\ {\isacharparenleft}resolve{\isacharunderscore}tac\ ctxt\ {\isacharbrackleft}allI{\isacharcomma}\ ballI{\isacharcomma}\ impI{\isacharbrackright}{\isacharparenright}{\isacharcomma}\isanewline
  \ \ \ \ \ \ \ \ \ \ REPEAT{\isacharunderscore}FIRST\ {\isacharparenleft}resolve{\isacharunderscore}tac\ ctxt\ {\isacharat}{\isacharbraceleft}thms\ analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}lemma{\isacharbraceright}{\isacharparenright}{\isacharcomma}\isanewline
  \ \ \ \ \ \ \ \ \ \ ALLGOALS\ {\isacharparenleft}asm{\isacharunderscore}simp{\isacharunderscore}tac\ {\isacharparenleft}put{\isacharunderscore}simpset\ Smartphone{\isachardot}analz{\isacharunderscore}image{\isacharunderscore}freshK{\isacharunderscore}ss\ ctxt{\isacharparenright}{\isacharparenright}{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\isanewline
  \ \ \ \ {\isachardoublequoteopen}for\ proving\ the\ Session\ Key\ Compromise\ theorem{\isachardoublequoteclose}\isanewline
  \isanewline
  \isacommand{method{\isacharunderscore}setup}\isamarkupfalse%
  \ possibility\ {\isacharequal}\ {\isacartoucheopen}\isanewline
  \ \ \ \ Scan{\isachardot}succeed\ {\isacharparenleft}fn\ ctxt\ {\isacharequal}{\isachargreater}\isanewline
  \ \ \ \ \ \ \ \ SIMPLE{\isacharunderscore}METHOD\ {\isacharparenleft}Smartphone{\isachardot}possibility{\isacharunderscore}tac\ ctxt{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\isanewline
  \ \ \ \ {\isachardoublequoteopen}for\ proving\ possibility\ theorems{\isachardoublequoteclose}\isanewline
  \isanewline
  \isacommand{method{\isacharunderscore}setup}\isamarkupfalse%
  \ basic{\isacharunderscore}possibility\ {\isacharequal}\ {\isacartoucheopen}\isanewline
  \ \ \ \ Scan{\isachardot}succeed\ {\isacharparenleft}fn\ ctxt\ {\isacharequal}{\isachargreater}\isanewline
  \ \ \ \ \ \ \ \ SIMPLE{\isacharunderscore}METHOD\ {\isacharparenleft}Smartphone{\isachardot}basic{\isacharunderscore}possibility{\isacharunderscore}tac\ ctxt{\isacharparenright}{\isacharparenright}{\isacartoucheclose}\isanewline
  \ \ \ \ {\isachardoublequoteopen}for\ proving\ possibility\ theorems{\isachardoublequoteclose}%
  \endisatagML
  {\isafoldML}%
  %
  \isadelimML
  \isanewline
  %
  \endisadelimML
  \isanewline
  \isacommand{lemma}\isamarkupfalse%
  \ knows{\isacharunderscore}subset{\isacharunderscore}knows{\isacharunderscore}Cons{\isacharcolon}\ {\isachardoublequoteopen}knows\ A\ evs\ {\isasymsubseteq}\ knows\ A\ {\isacharparenleft}e\ {\isacharhash}\ evs{\isacharparenright}{\isachardoublequoteclose}\isanewline
  %
  \isadelimproof
  %
  \endisadelimproof
  %
  \isatagproof
  \isacommand{by}\isamarkupfalse%
  \ {\isacharparenleft}induct\ e{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ knows{\isacharunderscore}Cons{\isacharparenright}%
  \endisatagproof
  {\isafoldproof}%
  %
  \isadelimproof
  \isanewline
  %
  \endisadelimproof
  \isanewline
  \isanewline
  \isacommand{declare}\isamarkupfalse%
  \ legalUse{\isacharunderscore}def\ {\isacharbrackleft}iff{\isacharbrackright}\ illegalUse{\isacharunderscore}def\ {\isacharbrackleft}iff{\isacharbrackright}\isanewline
  %
  \isadelimtheory
  \isanewline
  %
  \endisadelimtheory
  %
  \isatagtheory
  \isacommand{end}\isamarkupfalse%
  %
  \endisatagtheory
  {\isafoldtheory}%
  %
  \isadelimtheory
  %
  \endisadelimtheory
  %
  \end{isabellebody}%
  \endinput
  %:%file=~/workspace/dap-verification/scripts/Smartphone.thy%:%
  %:%6=13%:%
  %:%7=14%:%
  %:%12=15%:%
  %:%13=15%:%
  %:%18=15%:%
  %:%21=16%:%
  %:%22=17%:%
  %:%23=18%:%
  %:%24=18%:%
  %:%25=19%:%
  %:%26=20%:%
  %:%27=21%:%
  %:%28=22%:%
  %:%35=24%:%
  %:%45=26%:%
  %:%46=26%:%
  %:%47=27%:%
  %:%48=28%:%
  %:%49=30%:%
  %:%50=31%:%
  %:%51=31%:%
  %:%52=32%:%
  %:%61=36%:%
  %:%71=37%:%
  %:%72=37%:%
  %:%73=38%:%
  %:%74=39%:%
  %:%75=39%:%
  %:%76=40%:%
  %:%77=41%:%
  %:%78=42%:%
  %:%79=43%:%
  %:%80=43%:%
  %:%81=44%:%
  %:%82=45%:%
  %:%83=45%:%
  %:%84=46%:%
  %:%85=47%:%
  %:%86=48%:%
  %:%87=49%:%
  %:%94=51%:%
  %:%104=52%:%
  %:%105=52%:%
  %:%106=53%:%
  %:%107=54%:%
  %:%108=55%:%
  %:%109=55%:%
  %:%116=56%:%
  %:%117=56%:%
  %:%118=57%:%
  %:%119=57%:%
  %:%120=58%:%
  %:%126=58%:%
  %:%129=59%:%
  %:%130=64%:%
  %:%131=65%:%
  %:%132=65%:%
  %:%133=66%:%
  %:%140=67%:%
  %:%141=67%:%
  %:%142=68%:%
  %:%143=68%:%
  %:%144=69%:%
  %:%150=69%:%
  %:%153=70%:%
  %:%154=71%:%
  %:%155=72%:%
  %:%156=72%:%
  %:%157=73%:%
  %:%158=74%:%
  %:%159=75%:%
  %:%160=75%:%
  %:%161=76%:%
  %:%168=77%:%
  %:%169=77%:%
  %:%174=77%:%
  %:%177=78%:%
  %:%178=79%:%
  %:%179=80%:%
  %:%180=80%:%
  %:%181=81%:%
  %:%188=82%:%
  %:%189=82%:%
  %:%190=83%:%
  %:%191=83%:%
  %:%192=84%:%
  %:%198=84%:%
  %:%201=85%:%
  %:%202=87%:%
  %:%203=88%:%
  %:%204=88%:%
  %:%205=89%:%
  %:%206=90%:%
  %:%213=91%:%
  %:%214=91%:%
  %:%219=91%:%
  %:%222=92%:%
  %:%223=93%:%
  %:%224=94%:%
  %:%225=94%:%
  %:%226=95%:%
  %:%233=96%:%
  %:%234=96%:%
  %:%239=96%:%
  %:%242=97%:%
  %:%243=98%:%
  %:%244=99%:%
  %:%245=99%:%
  %:%252=100%:%
  %:%253=100%:%
  %:%254=101%:%
  %:%255=101%:%
  %:%256=102%:%
  %:%262=102%:%
  %:%265=103%:%
  %:%266=104%:%
  %:%267=105%:%
  %:%268=105%:%
  %:%275=106%:%
  %:%276=106%:%
  %:%277=107%:%
  %:%283=107%:%
  %:%286=108%:%
  %:%287=109%:%
  %:%288=110%:%
  %:%289=110%:%
  %:%296=111%:%
  %:%297=111%:%
  %:%298=112%:%
  %:%299=112%:%
  %:%300=113%:%
  %:%310=117%:%
  %:%312=118%:%
  %:%313=118%:%
  %:%320=119%:%
  %:%321=119%:%
  %:%326=119%:%
  %:%329=120%:%
  %:%330=121%:%
  %:%331=121%:%
  %:%338=122%:%
  %:%339=122%:%
  %:%344=122%:%
  %:%347=123%:%
  %:%348=124%:%
  %:%349=124%:%
  %:%356=126%:%
  %:%366=128%:%
  %:%367=128%:%
  %:%368=129%:%
  %:%371=130%:%
  %:%372=131%:%
  %:%376=131%:%
  %:%377=131%:%
  %:%378=132%:%
  %:%379=132%:%
  %:%380=133%:%
  %:%386=133%:%
  %:%389=134%:%
  %:%390=135%:%
  %:%391=136%:%
  %:%392=136%:%
  %:%393=137%:%
  %:%396=138%:%
  %:%397=139%:%
  %:%401=139%:%
  %:%402=139%:%
  %:%403=140%:%
  %:%404=140%:%
  %:%405=141%:%
  %:%406=141%:%
  %:%407=141%:%
  %:%412=141%:%
  %:%415=142%:%
  %:%416=143%:%
  %:%417=144%:%
  %:%418=144%:%
  %:%419=145%:%
  %:%420=146%:%
  %:%423=147%:%
  %:%424=148%:%
  %:%428=148%:%
  %:%429=148%:%
  %:%430=149%:%
  %:%431=149%:%
  %:%432=150%:%
  %:%438=150%:%
  %:%441=151%:%
  %:%442=152%:%
  %:%443=152%:%
  %:%444=153%:%
  %:%445=154%:%
  %:%448=155%:%
  %:%449=156%:%
  %:%453=156%:%
  %:%454=156%:%
  %:%455=157%:%
  %:%456=157%:%
  %:%457=158%:%
  %:%472=160%:%
  %:%482=162%:%
  %:%483=162%:%
  %:%490=163%:%
  %:%491=163%:%
  %:%496=163%:%
  %:%499=164%:%
  %:%500=165%:%
  %:%501=165%:%
  %:%508=166%:%
  %:%509=166%:%
  %:%514=166%:%
  %:%517=167%:%
  %:%518=168%:%
  %:%519=168%:%
  %:%526=169%:%
  %:%527=169%:%
  %:%532=169%:%
  %:%535=170%:%
  %:%536=171%:%
  %:%537=171%:%
  %:%544=172%:%
  %:%545=172%:%
  %:%550=172%:%
  %:%553=173%:%
  %:%554=174%:%
  %:%555=175%:%
  %:%556=175%:%
  %:%557=176%:%
  %:%564=177%:%
  %:%565=177%:%
  %:%566=178%:%
  %:%567=178%:%
  %:%568=179%:%
  %:%574=179%:%
  %:%577=180%:%
  %:%578=181%:%
  %:%579=181%:%
  %:%580=182%:%
  %:%581=182%:%
  %:%582=182%:%
  %:%583=183%:%
  %:%584=184%:%
  %:%585=185%:%
  %:%586=186%:%
  %:%587=187%:%
  %:%588=188%:%
  %:%589=189%:%
  %:%590=190%:%
  %:%591=190%:%
  %:%592=191%:%
  %:%593=192%:%
  %:%600=193%:%
  %:%601=193%:%
  %:%615=196%:%
  %:%631=197%:%
  %:%632=197%:%
  %:%633=198%:%
  %:%667=227%:%
  %:%670=228%:%
  %:%671=229%:%
  %:%672=230%:%
  %:%673=230%:%
  %:%674=231%:%
  %:%681=232%:%
  %:%682=232%:%
  %:%687=232%:%
  %:%690=233%:%
  %:%693=234%:%
  %:%698=235%:%
  %:%699=235%:%
  %:%704=240%:%
  %:%705=241%:%
  %:%706=242%:%
  %:%707=243%:%
  %:%708=243%:%
  %:%710=245%:%
  %:%711=246%:%
  %:%712=247%:%
  %:%713=248%:%
  %:%714=248%:%
  %:%716=250%:%
  %:%717=251%:%
  %:%722=251%:%
  %:%725=252%:%
  %:%726=253%:%
  %:%727=253%:%
  %:%734=254%:%
  %:%735=254%:%
  %:%740=254%:%
  %:%743=255%:%
  %:%744=256%:%
  %:%745=257%:%
  %:%746=257%:%
  %:%749=258%:%
  %:%754=259%:%